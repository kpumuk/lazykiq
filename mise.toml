[tools]
golang = "1.25.6"
golangci-lint = "2.7.2"
hugo-extended = "0.152.2"
lefthook = "2.0.13"

[tasks.ci]
description = "Format code and run all CI checks"
depends = ["format", "lint", "test"]

[tasks.lint]
description = "Run golangci-lint"
run = "golangci-lint run"

[tasks.format]
description = "Format with golangci-lint"
run = "golangci-lint fmt"
alias = "fmt"

[tasks.test]
description = "Run tests"
run = "go test ./..."

[tasks.coverage]
description = "Run tests with coverage"
run = "go test -coverprofile=coverage.out ./... && go tool cover -html=coverage.out"
alias = "cov"

[tasks.deps]
description = "Update development dependencies"
depends = ["deps-go", "deps-ruby"]

[tasks.deps-go]
description = "Update Go dependencies"
run = "go get -u ./... && go mod tidy"

[tasks.deps-ruby]
description = "Update Ruby dependencies"
run = "find . -maxdepth 1 -name 'Gemfile*' ! -name '*.lock' -exec mise exec ruby -- bundle update --gemfile '{}' --all \\;"
dir = "demo"

[tasks.website-dev]
description = "Run Hugo in development mode"
run = "bun dev --baseURL http://localhost:1313/lazykiq"
dir = "website"

[tasks.demo]
description = "Run the demo application"
run = "docker-compose -f docker-compose.yml up --build -d"
dir = "demo"
